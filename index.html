<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Hand Gesture Voice â€” Modular Final</title>

<!-- Styles -->
<link rel="stylesheet" href="style.css">

<!-- MediaPipe CDN libs -->
<script type="module">
  import { Hands } from 'https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js';
  import { Camera } from 'https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js';
  import { FaceMesh } from 'https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/face_mesh.js';
  window.Hands = Hands;
  window.Camera = Camera;
  window.FaceMesh = FaceMesh;
</script>

</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="video-box" id="videoWrap">
        <video id="video" autoplay playsinline></video>
        <canvas id="canvas"></canvas>
      </div>

      <div class="controls">
        <button id="btnCamera" class="primary">Start Camera</button>
        <button id="btnFullscreen">ğŸ–¥ï¸ Fullscreen Kamera</button>
        <button id="btnRecord">ğŸ¥ Rekam Gestur</button>
        <button id="btnStopRecord">â¹ï¸ Stop Rekam</button>
        <button id="btnAutoName">ğŸ”€ Auto-Name</button>
        <button id="btnSnapshot">ğŸ“¸ Snapshot</button>
        <a id="downloadLink" style="display:none"></a>
      </div>

      <div style="display:flex;gap:12px;margin-top:12px;align-items:center;">
        <div style="flex:1;">
          <label class="small">Nama Gestur</label><br>
          <input id="gestureName" placeholder="kosongkan untuk auto-name" style="width:100%;">
        </div>
        <div style="flex:1;">
          <label class="small">Respon Suara</label><br>
          <input id="gestureResponse" placeholder="Contoh: Halo!" style="width:100%;">
        </div>
        <div style="width:140px;">
          <label class="small">Cooldown (ms)</label><br>
          <input id="gestureCooldown" type="number" value="2500" style="width:100%;">
        </div>
      </div>

      <div style="display:flex;gap:12px;margin-top:8px;align-items:center;">
        <div style="flex:1;">
          <label class="small">Sensitivity (threshold)</label>
          <input id="sensitivity" type="range" min="0.8" max="5.0" step="0.1" value="3.0" style="width:100%;">
          <div class="tiny">Nilai lebih kecil = lebih ketat (lebih sulit cocok). Saat ini: <span id="sVal">3.0</span></div>
        </div>
        <div style="width:160px;">
          <label class="small">Global cooldown (ms)</label><br>
          <input id="globalCooldown" type="number" value="500" style="width:100%;">
        </div>
      </div>

      <div class="muted-box" style="margin-top:12px;">
        <div id="status" class="small">Status: menunggu kamera...</div>
        <div class="footer-note">Tips: tahan tombol <b>Rekam Gestur</b> selama ~1 detik untuk merekam beberapa frame. Setelah tersimpan, tunjukkan gestur untuk memicu respon suara. Kamera & FaceMesh berjalan bersamaan.</div>
      </div>
    </div>

    <div class="card">
      <div style="display:flex;justify-content:space-between;align-items:center;">
        <h3 style="margin:0">Daftar Gestur & Ekspresi</h3>
        <div style="display:flex;gap:8px;">
          <button id="exportBtn">â¬‡ï¸ Export</button>
          <input type="file" id="importFile" style="display:none"/>
          <button id="importBtn">â¬†ï¸ Import</button>
          <button id="clearBtn">ğŸ—‘ï¸ Clear All</button>
        </div>
      </div>

      <div id="gesturesList" class="list" style="margin-top:10px;max-height:320px;overflow:auto;"></div>

      <div style="margin-top:12px;">
        <div class="bubble-area" id="bubbleArea"></div>
      </div>

      <div style="margin-top:12px;" class="flex-col">
        <div class="row">
          <button id="saveBtn" class="primary">ğŸ’¾ Simpan Gestur</button>
          <button id="applySettings">Apply Settings</button>
        </div>
        <div class="small">Export/Import menyimpan seluruh template gesture (JSON). Simpan gesture sebelum export. Face expression auto diaktifkan â€” ada setting cooldown wajah di bawah.</div>
        <div style="margin-top:8px;">
          <label class="small">Face cooldown (ms)</label>
          <input id="faceCooldown" type="number" value="3000" style="width:120px;">
        </div>
      </div>
    </div>
  </div>

  <!-- JS Modules -->
  <script type="module" src="./gesture.js"></script>
  <script type="module" src="./face.js"></script>
  <script type="module" src="./speech.js"></script>
  <script type="module" src="./main.js"></script>
</body>
</html>
